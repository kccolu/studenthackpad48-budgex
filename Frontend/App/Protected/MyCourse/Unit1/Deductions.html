<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 4: Standard vs. Itemized Deductions - Budgex</title>
    <link rel="stylesheet" href="lesson.css">
</head>
<body>
    <script src="../Dashboard/api-client.js"></script>
    <script>
        // Check authentication on page load
        if (!api.isAuthenticated()) {
            window.location.href = '../../Public/Auth/signin.html';
        }
    </script>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">Budgex</div>

        <nav class="sidebar-nav">
            <a href="../../../Protected/Dashboard/dashboard-interactive.html" class="nav-item">
                <span class="nav-icon icon-home"></span>
                <span>Dashboard</span>
            </a>
            <a href="../mycourses.html" class="nav-item active">
                <span class="nav-icon icon-courses"></span>
                <span>My Courses</span>
            </a>
            <a href="../../Tools/tools.html" class="nav-item">
                <span class="nav-icon icon-tools"></span>
                <span>Tools</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar">JD</div>
                <div class="user-info">
                    <div class="user-name" id="user-name">John Doe</div>
                    <div class="user-email" id="user-email">john@example.com</div>
                </div>
            </div>
            <a href="#" class="nav-item" id="logout-btn">
                <span class="nav-icon icon-logout"></span>
                <span>Logout</span>
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Lesson Header -->
        <header class="lesson-header">
            <div class="breadcrumb">
                <a href="mycourses.html">My Courses</a>
                <span class="separator">/</span>
                <a href="unit.html?course=tax-fundamentals">Tax Fundamentals</a>
                <span class="separator">/</span>
                <span class="current">Lesson 4</span>
            </div>
            <h1 class="lesson-title">Standard vs. Itemized Deductions</h1>
            <div class="lesson-meta">
                <span class="lesson-duration">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="8" cy="8" r="7" stroke="#fbbf24" stroke-width="2" fill="none"/>
                        <path d="M8 4 L8 8 L11 8" stroke="#fbbf24" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    60 minutes
                </span>
                <span class="lesson-progress-indicator">
                    <span id="current-section">1</span> / <span id="total-sections">5</span>
                </span>
            </div>
        </header>

        <!-- Progress Bar -->
        <div class="lesson-progress-bar">
            <div class="lesson-progress-fill" id="lesson-progress-fill" style="width: 0%"></div>
        </div>

        <!-- Lesson Content Container -->
        <div class="lesson-container">
            <!-- Section 1: What Are Deductions? -->
            <section class="lesson-section active" id="section-1">
                <div class="section-number">Section 1 of 5</div>
                <h2 class="section-title">What Are Tax Deductions?</h2>

                <div class="content-block">
                    <p class="content-text">
                        <strong>Tax deductions</strong> reduce your taxable income, which lowers the amount of taxes you owe. Think of deductions as expenses that the government allows you to subtract from your income before calculating your tax bill.
                    </p>
                    <p class="content-text">
                        The more deductions you claim, the lower your taxable income, and therefore the less tax you pay.
                    </p>
                </div>

                <div class="visual-card">
                    <h3 class="visual-title">How Deductions Save You Money</h3>
                    <div class="tax-flow-diagram">
                        <div class="flow-step">
                            <div class="flow-icon">ðŸ’µ</div>
                            <div class="flow-label">Gross Income<br>$80,000</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="flow-icon">âž–</div>
                            <div class="flow-label">Deductions<br>-$14,600</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="flow-icon">ðŸ“Š</div>
                            <div class="flow-label">Taxable Income<br>$65,400</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="flow-icon">ðŸ’°</div>
                            <div class="flow-label">Calculate Tax<br>on $65,400</div>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="10" stroke="#fbbf24" stroke-width="2"/>
                            <path d="M12 8 L12 12 L12 16" stroke="#fbbf24" stroke-width="2" stroke-linecap="round"/>
                            <circle cx="12" cy="6" r="1" fill="#fbbf24"/>
                        </svg>
                    </div>
                    <div class="info-content">
                        <h3 class="info-title">Deduction vs. Credit</h3>
                        <p>A <strong>deduction</strong> reduces your taxable income. A <strong>tax credit</strong> reduces your tax bill dollar-for-dollar. Credits are more valuable!</p>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn-secondary" disabled>Previous</button>
                    <button class="btn-primary next-btn" onclick="goToSection(2)">Next Section</button>
                </div>
            </section>

            <!-- Section 2: The Standard Deduction -->
            <section class="lesson-section" id="section-2">
                <div class="section-number">Section 2 of 5</div>
                <h2 class="section-title">The Standard Deduction</h2>

                <div class="content-block">
                    <p class="content-text">
                        The <strong>standard deduction</strong> is a fixed dollar amount that reduces your taxable income. You don't need to track expenses or keep receiptsâ€”it's automatic.
                    </p>
                    <p class="content-text">
                        Most taxpayers (about 90%) take the standard deduction because it's simple and often larger than their itemized deductions.
                    </p>
                </div>

                <div class="visual-card">
                    <h3 class="visual-title">2024 Standard Deduction Amounts</h3>
                    <div class="tax-breakdown-chart">
                        <div class="chart-bar-container">
                            <div class="chart-label">Single Filer</div>
                            <div class="chart-bar-wrapper">
                                <div class="chart-bar" style="width: 60%; background: #fbbf24;">
                                    <span class="chart-value">$14,600</span>
                                </div>
                            </div>
                        </div>
                        <div class="chart-bar-container">
                            <div class="chart-label">Married Filing Jointly</div>
                            <div class="chart-bar-wrapper">
                                <div class="chart-bar" style="width: 100%; background: #2ed573;">
                                    <span class="chart-value">$29,200</span>
                                </div>
                            </div>
                        </div>
                        <div class="chart-bar-container">
                            <div class="chart-label">Head of Household</div>
                            <div class="chart-bar-wrapper">
                                <div class="chart-bar" style="width: 75%; background: #f59e0b;">
                                    <span class="chart-value">$21,900</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="highlight-box">
                    <h3>Benefits of the Standard Deduction:</h3>
                    <ul class="services-list">
                        <li><span class="check-icon">âœ“</span> No need to track expenses or keep receipts</li>
                        <li><span class="check-icon">âœ“</span> Simple and straightforward</li>
                        <li><span class="check-icon">âœ“</span> Faster tax filing</li>
                        <li><span class="check-icon">âœ“</span> Automatically adjusted for inflation each year</li>
                        <li><span class="check-icon">âœ“</span> Available to everyone</li>
                    </ul>
                </div>

                <div class="navigation-buttons">
                    <button class="btn-secondary prev-btn" onclick="goToSection(1)">Previous</button>
                    <button class="btn-primary next-btn" onclick="goToSection(3)">Next Section</button>
                </div>
            </section>

            <!-- Section 3: Itemized Deductions -->
            <section class="lesson-section" id="section-3">
                <div class="section-number">Section 3 of 5</div>
                <h2 class="section-title">Itemized Deductions</h2>

                <div class="content-block">
                    <p class="content-text">
                        <strong>Itemized deductions</strong> allow you to deduct specific expenses you paid during the year. You must keep receipts and records to prove these expenses.
                    </p>
                    <p class="content-text">
                        You should only itemize if your total itemized deductions exceed the standard deduction for your filing status.
                    </p>
                </div>

                <div class="impact-cards">
                    <div class="impact-card">
                        <div class="impact-number">1</div>
                        <h3 class="impact-title">Medical & Dental Expenses</h3>
                        <p class="impact-description">
                            You can deduct unreimbursed medical and dental expenses that exceed 7.5% of your adjusted gross income (AGI).
                        </p>
                        <div class="example-box">
                            <strong>Example:</strong><br>
                            AGI: $60,000<br>
                            7.5% threshold: $4,500<br>
                            Medical costs: $8,000<br>
                            <strong style="color: #fbbf24;">Deductible: $3,500</strong>
                        </div>
                    </div>

                    <div class="impact-card">
                        <div class="impact-number">2</div>
                        <h3 class="impact-title">State & Local Taxes (SALT)</h3>
                        <p class="impact-description">
                            Deduct state and local income taxes OR sales taxes, plus property taxes. Limited to $10,000 total.
                        </p>
                    </div>

                    <div class="impact-card">
                        <div class="impact-number">3</div>
                        <h3 class="impact-title">Mortgage Interest</h3>
                        <p class="impact-description">
                            Interest paid on mortgages up to $750,000 is deductible. This is one of the largest itemized deductions for homeowners.
                        </p>
                    </div>

                    <div class="impact-card">
                        <div class="impact-number">4</div>
                        <h3 class="impact-title">Charitable Contributions</h3>
                        <p class="impact-description">
                            Donations to qualified charities are deductible. Keep receipts for all donations over $250.
                        </p>
                    </div>
                </div>

                <div class="summary-card">
                    <h3>ðŸ“‹ Other Common Itemized Deductions</h3>
                    <ul class="summary-list">
                        <li>Casualty and theft losses (from federally declared disasters)</li>
                        <li>Gambling losses (up to the amount of gambling winnings)</li>
                        <li>Investment interest expenses</li>
                        <li>Tax preparation fees (for prior years)</li>
                    </ul>
                </div>

                <div class="navigation-buttons">
                    <button class="btn-secondary prev-btn" onclick="goToSection(2)">Previous</button>
                    <button class="btn-primary next-btn" onclick="goToSection(4)">Next Section</button>
                </div>
            </section>

            <!-- Section 4: Knowledge Check Quiz -->
            <section class="lesson-section" id="section-4">
                <div class="section-number">Section 4 of 5</div>
                <h2 class="section-title">Knowledge Check</h2>

                <div class="content-block">
                    <p class="content-text">
                        Test your understanding of deductions and when to itemize.
                    </p>
                </div>

                <div class="quiz-container">
                    <!-- Question 1 -->
                    <div class="quiz-question" id="quiz-1">
                        <div class="question-header">
                            <span class="question-number">Question 1 of 3</span>
                        </div>
                        <h3 class="question-text">What is the main advantage of the standard deduction?</h3>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectAnswer(1, 'A', false)">
                                <input type="radio" name="q1" id="q1-a">
                                <label for="q1-a">A) It's always larger than itemized deductions</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(1, 'B', true)">
                                <input type="radio" name="q1" id="q1-b">
                                <label for="q1-b">B) It's simple and doesn't require tracking expenses</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(1, 'C', false)">
                                <input type="radio" name="q1" id="q1-c">
                                <label for="q1-c">C) You can claim it in addition to itemized deductions</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(1, 'D', false)">
                                <input type="radio" name="q1" id="q1-d">
                                <label for="q1-d">D) It increases every month</label>
                            </div>
                        </div>
                        <div class="quiz-feedback" id="feedback-1"></div>
                    </div>

                    <!-- Question 2 -->
                    <div class="quiz-question" id="quiz-2" style="display: none;">
                        <div class="question-header">
                            <span class="question-number">Question 2 of 3</span>
                        </div>
                        <h3 class="question-text">You're a single filer with $12,000 in itemized deductions. Should you itemize or take the standard deduction?</h3>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectAnswer(2, 'A', false)">
                                <input type="radio" name="q2" id="q2-a">
                                <label for="q2-a">A) Itemize because you have deductions</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(2, 'B', true)">
                                <input type="radio" name="q2" id="q2-b">
                                <label for="q2-b">B) Take the standard deduction ($14,600) because it's higher</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(2, 'C', false)">
                                <input type="radio" name="q2" id="q2-c">
                                <label for="q2-c">C) Claim both to maximize deductions</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(2, 'D', false)">
                                <input type="radio" name="q2" id="q2-d">
                                <label for="q2-d">D) Don't claim any deductions</label>
                            </div>
                        </div>
                        <div class="quiz-feedback" id="feedback-2"></div>
                    </div>

                    <!-- Question 3 -->
                    <div class="quiz-question" id="quiz-3" style="display: none;">
                        <div class="question-header">
                            <span class="question-number">Question 3 of 3</span>
                        </div>
                        <h3 class="question-text">Which of the following is NOT a common itemized deduction?</h3>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectAnswer(3, 'A', false)">
                                <input type="radio" name="q3" id="q3-a">
                                <label for="q3-a">A) Mortgage interest</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(3, 'B', false)">
                                <input type="radio" name="q3" id="q3-b">
                                <label for="q3-b">B) Charitable donations</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(3, 'C', false)">
                                <input type="radio" name="q3" id="q3-c">
                                <label for="q3-c">C) State and local taxes (up to $10,000)</label>
                            </div>
                            <div class="quiz-option" onclick="selectAnswer(3, 'D', true)">
                                <input type="radio" name="q3" id="q3-d">
                                <label for="q3-d">D) Groceries and everyday expenses</label>
                            </div>
                        </div>
                        <div class="quiz-feedback" id="feedback-3"></div>
                    </div>

                    <div class="quiz-results" id="quiz-results" style="display: none;">
                        <h3>Quiz Complete! ðŸŽ‰</h3>
                        <p class="quiz-score">You got <span id="quiz-score">0</span> out of 3 correct!</p>
                        <p class="quiz-message" id="quiz-message"></p>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn-secondary prev-btn" onclick="goToSection(3)">Previous</button>
                    <button class="btn-primary next-btn" id="quiz-next-btn" onclick="goToSection(5)" disabled>Next Section</button>
                </div>
            </section>

            <!-- Section 5: Summary & Next Steps -->
            <section class="lesson-section" id="section-5">
                <div class="section-number">Section 5 of 5</div>
                <h2 class="section-title">Lesson Summary & Unit Completion</h2>

                <div class="summary-card">
                    <h3>ðŸŽ¯ What You Learned Today</h3>
                    <ul class="summary-list">
                        <li><strong>Deductions reduce your taxable income</strong>, lowering your tax bill</li>
                        <li><strong>Standard deduction</strong> is automatic: $14,600 (single), $29,200 (married)</li>
                        <li><strong>Itemized deductions</strong> require tracking specific expenses</li>
                        <li><strong>Only itemize if your total exceeds</strong> the standard deduction</li>
                        <li><strong>Common itemized deductions:</strong> mortgage interest, SALT, medical, charitable</li>
                    </ul>
                </div>

                <div class="highlight-box" style="background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(46, 213, 115, 0.1)); border: 2px solid #fbbf24;">
                    <h3 style="color: #fbbf24;">ðŸŽŠ Unit 1 Complete!</h3>
                    <p style="font-size: 1.1rem; margin: 1rem 0;">
                        Congratulations! You've finished all 4 lessons in <strong>Unit 1: Tax Fundamentals</strong>. You now understand:
                    </p>
                    <ul class="services-list">
                        <li><span class="check-icon">âœ“</span> What taxes are and why we pay them</li>
                        <li><span class="check-icon">âœ“</span> How tax brackets and rates work</li>
                        <li><span class="check-icon">âœ“</span> Different types of income and their tax treatment</li>
                        <li><span class="check-icon">âœ“</span> Standard vs. itemized deductions</li>
                    </ul>
                </div>

                <div class="next-lesson-preview">
                    <h3>ðŸ“š What's Next: Unit 2</h3>
                    <p>Continue your tax education journey with Unit 2, where you'll dive deeper into tax credits, retirement accounts, and advanced strategies.</p>
                    <div class="preview-topics">
                        <span class="preview-tag">Tax Credits</span>
                        <span class="preview-tag">Retirement Savings</span>
                        <span class="preview-tag">Advanced Planning</span>
                    </div>
                </div>

                <div class="completion-actions">
                    <button class="btn-secondary prev-btn" onclick="goToSection(4)">Previous</button>
                    <button class="btn-primary complete-btn" onclick="completeLesson()">Complete Lesson & Unit</button>
                </div>
            </section>
        </div>
    </main>

    <script>
        let currentSection = 1;
        let quizScore = 0;
        let quizAnswered = [false, false, false];
        let currentQuizQuestion = 1;

        // Update progress bar
        function updateProgress() {
            const progress = (currentSection / 5) * 100;
            document.getElementById('lesson-progress-fill').style.width = progress + '%';
            document.getElementById('current-section').textContent = currentSection;
        }

        // Navigate between sections
        function goToSection(sectionNum) {
            // Hide current section
            document.getElementById(`section-${currentSection}`).classList.remove('active');

            // Show new section
            currentSection = sectionNum;
            document.getElementById(`section-${currentSection}`).classList.add('active');

            // Update progress
            updateProgress();

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Quiz functionality
        function selectAnswer(questionNum, answer, isCorrect) {
            const feedback = document.getElementById(`feedback-${questionNum}`);
            const option = event.currentTarget;

            // Disable all options for this question
            const allOptions = option.parentElement.querySelectorAll('.quiz-option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
                opt.classList.add('disabled');
            });

            // Mark selected option
            option.classList.add(isCorrect ? 'correct' : 'incorrect');

            if (isCorrect) {
                if (!quizAnswered[questionNum - 1]) {
                    quizScore++;
                    quizAnswered[questionNum - 1] = true;
                }
                feedback.innerHTML = `
                    <div class="feedback-correct">
                        <span class="feedback-icon">âœ“</span>
                        <span>Correct! Great job!</span>
                    </div>
                `;
            } else {
                quizAnswered[questionNum - 1] = true;
                feedback.innerHTML = `
                    <div class="feedback-incorrect">
                        <span class="feedback-icon">âœ—</span>
                        <span>Not quite. Review the material and try again!</span>
                    </div>
                `;
            }

            feedback.style.display = 'block';

            // Show next question or results
            setTimeout(() => {
                if (questionNum < 3) {
                    document.getElementById(`quiz-${questionNum}`).style.display = 'none';
                    document.getElementById(`quiz-${questionNum + 1}`).style.display = 'block';
                    currentQuizQuestion++;
                } else {
                    // Show results
                    showQuizResults();
                }
            }, 1500);
        }

        function showQuizResults() {
            document.getElementById('quiz-3').style.display = 'none';
            document.getElementById('quiz-results').style.display = 'block';
            document.getElementById('quiz-score').textContent = quizScore;

            const messageEl = document.getElementById('quiz-message');
            if (quizScore === 3) {
                messageEl.innerHTML = 'ðŸŒŸ Perfect score! You\'ve mastered deductions!';
            } else if (quizScore === 2) {
                messageEl.innerHTML = 'ðŸ‘ Good job! You understand most of the concepts.';
            } else {
                messageEl.innerHTML = 'ðŸ“– Keep learning! Review the material and you\'ll get it.';
            }

            // Enable next button
            document.getElementById('quiz-next-btn').disabled = false;
        }

        // Complete lesson
        async function completeLesson() {
            try {
                // Mark lesson as complete in backend
                await api.completeLesson('tax-fundamentals', 1, 4, quizScore);

                // Show success message
                alert('ðŸŽ‰ Congratulations! You\'ve completed Lesson 4 and finished Unit 1! Amazing work!');

                // Redirect back to unit page
                window.location.href = 'unit.html?course=tax-fundamentals';
            } catch (error) {
                console.error('Failed to mark lesson complete:', error);
                // Still redirect even if API fails
                window.location.href = 'unit.html?course=tax-fundamentals';
            }
        }

        // Logout functionality
        document.getElementById('logout-btn').addEventListener('click', (e) => {
            e.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                api.logout();
            }
        });

        // Initialize
        updateProgress();
    </script>
</body>
</html>
